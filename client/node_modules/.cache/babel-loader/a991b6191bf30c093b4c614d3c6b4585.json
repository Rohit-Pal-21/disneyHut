{"ast":null,"code":"var _jsxFileName = \"/home/acer/My  Movies WAD Project/disneyHut/client/src/pages/SearchResults.js\",\n    _s = $RefreshSig$();\n\nimport SearchCategory from \"../components/general/Category\";\nimport Footer from \"../components/general/Footer\";\nimport { useGetSearchResultsQuery } from \"../redux/tmdbApi\";\nimport { resetPage } from \"../redux/layoutSlice\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { useState, useEffect } from \"react\";\nimport useUniqueData from \"../hooks/useUniqueData\";\nimport { useSearchParams } from \"react-router-dom\";\nimport ListingScreen from \"../loaders/screens/ListingScreen\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst SearchResults = () => {\n  _s();\n\n  const {\n    isSearch,\n    page\n  } = useSelector(state => state.layout);\n  const [searchParam] = useSearchParams();\n  const [waiting, setWaiting] = useState(true);\n  const {\n    data,\n    isFetching,\n    isLoading\n  } = useGetSearchResultsQuery({\n    query: searchParam.get(\"q\"),\n    page: page\n  }, {\n    skip: waiting\n  });\n  const [final, setFinal] = useState([]);\n  const dispatch = useDispatch();\n  const {\n    uniqueItems\n  } = useUniqueData(final); // Debounce fetch\n\n  useEffect(() => {\n    setWaiting(true);\n    const handler = setTimeout(() => {\n      setWaiting(false);\n    }, 500);\n    return () => clearTimeout(handler);\n  }, [searchParam]);\n  useEffect(() => {\n    if (data && !isFetching) {\n      setFinal(final => final.concat(...data.results));\n    }\n  }, [data, isFetching]); // Reset to page 1 when unmounts\n\n  useEffect(() => {\n    return () => {\n      dispatch(resetPage());\n      setFinal([]);\n    };\n  }, [dispatch]); // Reset Page && Clear data on searchQuery\n\n  useEffect(() => {\n    if (searchParam) {\n      setFinal([]);\n      dispatch(resetPage());\n    }\n  }, [searchParam, dispatch]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `w-full ${isSearch ? \"pt-14 md:pt-14\" : \"\"} transition-all`,\n    children: !isLoading && data ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(SearchCategory, {\n        data: uniqueItems,\n        isFetching: isFetching,\n        heading: `Results for: ${searchParam.get(\"q\") ? searchParam.get(\"q\") : \"\"}`,\n        totalPages: data === null || data === void 0 ? void 0 : data.total_pages\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true) : /*#__PURE__*/_jsxDEV(ListingScreen, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 5\n  }, this);\n};\n\n_s(SearchResults, \"st/qm8MzQMa3RSiqPGcqC1BNfmY=\", false, function () {\n  return [useSelector, useSearchParams, useGetSearchResultsQuery, useDispatch, useUniqueData];\n});\n\n_c = SearchResults;\nexport default SearchResults;\n\nvar _c;\n\n$RefreshReg$(_c, \"SearchResults\");","map":{"version":3,"names":["SearchCategory","Footer","useGetSearchResultsQuery","resetPage","useSelector","useDispatch","useState","useEffect","useUniqueData","useSearchParams","ListingScreen","SearchResults","isSearch","page","state","layout","searchParam","waiting","setWaiting","data","isFetching","isLoading","query","get","skip","final","setFinal","dispatch","uniqueItems","handler","setTimeout","clearTimeout","concat","results","total_pages"],"sources":["/home/acer/My  Movies WAD Project/disneyHut/client/src/pages/SearchResults.js"],"sourcesContent":["import SearchCategory from \"../components/general/Category\";\nimport Footer from \"../components/general/Footer\";\nimport { useGetSearchResultsQuery } from \"../redux/tmdbApi\";\nimport { resetPage } from \"../redux/layoutSlice\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { useState, useEffect } from \"react\";\nimport useUniqueData from \"../hooks/useUniqueData\";\nimport { useSearchParams } from \"react-router-dom\";\nimport ListingScreen from \"../loaders/screens/ListingScreen\";\n\nconst SearchResults = () => {\n  const { isSearch, page } = useSelector((state) => state.layout);\n  const [searchParam] = useSearchParams();\n  const [waiting, setWaiting] = useState(true);\n\n  const { data, isFetching, isLoading } = useGetSearchResultsQuery({\n    query: searchParam.get(\"q\"),\n    page: page,\n  }, {skip: waiting});\n  const [final, setFinal] = useState([]);\n  const dispatch = useDispatch();\n  const { uniqueItems } = useUniqueData(final);\n\n  // Debounce fetch\n  useEffect(() => {\n    setWaiting(true);\n    const handler = setTimeout(() => {\n      setWaiting(false);\n    }, 500);\n\n    return () => clearTimeout(handler);\n  },[searchParam])\n\n  useEffect(() => {\n    if (data && !isFetching) {\n      setFinal((final) => final.concat(...data.results));\n    }\n  }, [data, isFetching]);\n\n  // Reset to page 1 when unmounts\n  useEffect(() => {\n    return () => {\n      dispatch(resetPage());\n      setFinal([]);\n    };\n  }, [dispatch]);\n\n  // Reset Page && Clear data on searchQuery\n  useEffect(() => {\n    if (searchParam) {\n      setFinal([]);\n      dispatch(resetPage());\n    }\n  }, [searchParam, dispatch]);\n\n  return (\n    <div\n      className={`w-full ${isSearch ? \"pt-14 md:pt-14\" : \"\"} transition-all`}\n    >\n      {!isLoading && data\n      ?\n      <>\n      <SearchCategory\n        data={uniqueItems}\n        isFetching={isFetching}\n        heading={`Results for: ${\n          searchParam.get(\"q\") ? searchParam.get(\"q\") : \"\"\n        }`}\n        totalPages={data?.total_pages}\n      />\n      <Footer />\n      </>\n      :\n      <ListingScreen />\n      }\n    </div>\n  );\n};\nexport default SearchResults;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}